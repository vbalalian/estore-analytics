
version: 2

models:

  - name: dim_categories
    description: >
      Dimension table for product categories. Extracted from staging events data.
    columns:

      - name: raw_category_id
        description: "Original unique identifier for the product category"
        tests:
          - not_null
          - unique

      - name: category_code
        description: "All hierarchical category codes associated with the product category, separated by commas"

      - name: category_lvl_1
        description: "First level of hierarchical category (e.g. electronics.smartphone returns electronics)"

      - name: category_lvl_2
        description: "Second level of hierarchical category (e.g. electronics.smartphone returns smartphone)"

      - name: category_lvl_3
        description: "Third level of hierarchical category (if applicable)"

      - name: category_lvl_4
        description: "Fourth level of hierarchical category (if applicable)"
        
  - name: dim_products
    description: >
      Dimension table for products. Extracted from staging events data.
    columns:
      - name: product_id
        description: "Unique identifier for the product"
        tests:
          - not_null
          - unique

      - name: brand
        description: "Brand of the product"

      - name: category_code
        description: "Category code associated with the product"

      - name: category_lvl_1
        description: "First level of hierarchical category associated with the product"

      - name: category_lvl_2
        description: "Second level of hierarchical category associated with the product" 

      - name: category_lvl_3
        description: "Third level of hierarchical category associated with the product"
      
      - name: category_lvl_4
        description: "Fourth level of hierarchical category associated with the product"

  - name: dim_users
    description: >
      Dimension table for users. Extracted from staging events data.
    columns:
      - name: user_id
        description: "Unique identifier for the user"
        tests:
          - not_null
          - unique

      - name: first_event_time
        description: "Timestamp of the user's first interaction with the platform"
        tests:
          - not_null

      - name: first_event_date
        description: "Date of the user's first interaction with the platform"
        tests:
          - not_null

      - name: last_event_time
        description: "Timestamp of the user's most recent interaction with the platform"
        tests:
          - not_null
      
      - name: last_event_date
        description: "Date of the user's most recent interaction with the platform"
        tests:
          - not_null

      - name: session_count
        description: "Total number of sessions initiated by the user"
        tests:
          - not_null
      
      - name: event_count
        description: "Total number of events generated by the user"
        tests:
          - not_null

  - name: fct_events
    description: >
      Fact table for user events. Extracted from staging events data.
    columns:
      - name: event_id
        description: "Unique identifier for the event"
        tests:
          - not_null
          - unique

      - name: event_time
        description: "Timestamp when the event occurred"
        tests:
          - not_null

      - name: event_date
        description: "Date when the event occurred"
        tests:
          - not_null

      - name: event_type
        description: "Type of the event (e.g., view, click, purchase)"
        tests:
          - not_null

      - name: user_id
        description: "Identifier for the user who generated the event"
        tests:
          - not_null

      - name: user_session
        description: "Identifier for the session during which the event occurred"
        tests:
          - not_null

      - name: product_id
        description: "Identifier for the product associated with the event (if applicable)"

      - name: category_code
        description: "Category code associated with the product (if applicable)"

      - name: category_id
        description: "Category id associated with the product (if applicable)"

      - name: brand
        description: "Brand of the product associated with the event (if applicable)"

      - name: price
        description: "Price of the product associated with the event (if applicable)"

      - name: quantity
        description: "Quantity of the product involved in the event (set to 1 for downstream aggregations)"

      - name: event_hour
        description: "Hour when the event occurred (0-23)"
        tests:
          - not_null

      - name: is_purchase
        description: "Indicator if the event is a purchase event (1 for purchase, 0 otherwise)"
        tests:
          - not_null

      - name: is_cart_add
        description: "Indicator if the event is an add-to-cart event (1 for add-to-cart, 0 otherwise)"
        tests:
          - not_null

      - name: is_view
        description: "Indicator if the event is a view event (1 for view, 0 otherwise)"
        tests:
          - not_null
      
      - name: revenue
        description: "Revenue generated from the event (price * quantity for purchase events, 0 otherwise)"

  - name: fct_sessions
    description: >
      Fact table for user sessions. Extracted from staging events data.
    columns:
      - name: session_id
        description: "Unique identifier for the user session"
        tests:
          - not_null
          - unique

      - name: user_id
        description: "Identifier for the user who initiated the session"
        tests:
          - not_null

      - name: session_start_time
        description: "Timestamp when the session started"
        tests:
          - not_null

      - name: session_end_time
        description: "Timestamp when the session ended"
        tests:
          - not_null

      - name: event_count
        description: "Total number of events that occurred during the session"
        tests:
          - not_null

      - name: unique_product_count
        description: "Number of unique products interacted with during the session"
        tests:
          - not_null

      - name: cart_additions
        description: "Total number of add-to-cart events during the session"

      - name: purchase_count
        description: "Total number of purchase events during the session"
      
      - name: view_count
        description: "Total number of view events during the session"

      - name: total_revenue
        description: "Total revenue generated from purchase events during the session"

      - name: converted
        description: "Indicator if the session included at least one purchase event (1 for yes, 0 for no)"
        tests:
          - not_null